---
title: "ETC5512: Wild Caught Data"
---

```{r setup, include = FALSE}
# please add any R-packages used here in DESCRIPTION imports
library(yaml)
library(stringr)
library(tibble)
library(dplyr)
library(purrr)
library(glue)
library(knitr)
library(kableExtra)
knitr::opts_chunk$set(echo = FALSE)
```

```{r fns}
make_rectangular <- function(.data) {
  l <- map(.data, ~ map(.x, as.character))
  bind_rows(map_dfr(l, ~ tibble(!!!.x)))
}


ui_list <- function(vec) {
  for (x in vec) {
    cat("-", x, "\n")
  }
}
```

```{r staffs}
dat <- read_yaml("_course.yml")
team_df <- make_rectangular(dat$team)
schedule_df <- make_rectangular(dat$schedule)
start_date <- as.Date(dat$semester$start, "%d/%m/%Y")
midsem_date <- as.Date(dat$semester$midsem, "%d/%m/%Y")
sem_dates <- as.Date(setdiff(seq(start_date, start_date + 7 * 13, by = 7), midsem_date), origin = "1970-01-01")
assess_df <- make_rectangular(dat$assessments) %>%
  mutate(
    due_week = as.integer(due_week),
    release_week = as.integer(release_week)
  )

nlecturer <- sum(team_df$role == "lecturer")
ntutor <- sum(team_df$role == "tutor")
```

## Lecturer`r ifelse(nlecturer > 1, 's', '')`

```{r lecturers, results="asis"}
team_df %>%
  filter(role == "lecturer") %>%
  pull(name) %>%
  ui_list()
```

## Tutor`r ifelse(ntutor > 1, 's', '')`

```{r tutors, results="asis"}
team_df %>%
  filter(role == "tutor") %>%
  pull(name) %>%
  ui_list()
```

## Consultations

<!-- All consultations will be in using zoom. Check Moodle for the links. -->

```{r consult, results="asis"}
team_df %>%
  filter(!is.na(consult)) %>%
  mutate(name = gsub(" (Chief Examiner)", "", name, fixed = T)) %>%
  mutate(consult_print = glue::glue("**{name}**: {consult}")) %>%
  pull(consult_print) %>%
  ui_list()
```

## Schedule

-   Lectures: **Wed 11 am-1 pm** on campus
-   Tutorials:
    -   A: **Wed 3:30 pm - 5 pm** on campus
    -   B: **Fri 11 am - 12:20 pm** on campus
    -   C: **Fri 12:30 - 2: 00 pm** on campus

There are no lectures, tutorials or consultations during the mid-semester break. You are expected to attend the lecture and ONE tutorial stream. Please see your timetable for which tutorial stream you are scheduled in.

Note that there is a weekly quiz that is due on Friday at 10:00 AM.

```{r}
schedule_df <- schedule_df %>%
  mutate(
    weekno = as.integer(week),
    date = c("", format(sem_dates[weekno[-1]], "%b %d")), # ifelse(weekno != 0, format(sem_dates[weekno], "%b %d"), ""),
    week = ifelse(week == "0", "", week)
  ) %>%
  left_join(select(assess_df, assess_name = name, due_week),
    by = c("weekno" = "due_week")
  ) %>%
  mutate(
    assessment = case_when(
      !is.na(assess_name) & weekno == 0 ~ glue("{assess_name} are due weekly"),
      !is.na(assess_name) ~ glue("{assess_name} is due"),
      TRUE ~ ""
    ),
    lecture_a = file.exists(sprintf("lectures/lecture-%.2dA.html", weekno)),
    lecture_b = file.exists(sprintf("lectures/lecture-%.2dB.html", weekno)),
    lecture = file.exists(sprintf("lectures/lecture-%.2d.html", weekno)),
    tutorial = file.exists(sprintf("tutorials/tutorial-%.2d.html", weekno)),
    solution = file.exists(sprintf("tutorials/tutorial-%.2dsol.html", weekno))
  ) %>%
  mutate(
    slides = case_when(
      lecture_a & lecture_b ~ glue("A: ", "<a class='fa fa-link' href='lectures/{sprintf(\"lecture-%.2dA.html\", weekno)}' target='_blank'></a> <a class='fab fa-r-project' href='lectures/{sprintf(\"lecture-%.2dA.Rmd\", weekno)}' target='_blank'></a> <a class='fa fa-file-pdf' href='lectures/{sprintf(\"lecture-%.2dA.pdf\", weekno)}' target='_blank'></a>", " ; ", "B: ", "<a class='fa fa-link' href='lectures/{sprintf(\"lecture-%.2dB.html\", weekno)}' target='_blank'></a> <a class='fab fa-r-project' href='lectures/{sprintf(\"lecture-%.2dB.Rmd\", weekno)}' target='_blank'></a> <a class='fa fa-file-pdf' href='lectures/{sprintf(\"lecture-%.2dB.pdf\", weekno)}' target='_blank'></a>"),
      lecture_a ~ glue("A: ", "<a class='fa fa-link' href='lectures/{sprintf(\"lecture-%.2dA.html\", weekno)}' target='_blank'></a> <a class='fab fa-r-project' href='lectures/{sprintf(\"lecture-%.2dA.Rmd\", weekno)}' target='_blank'></a> <a class='fa fa-file-pdf' href='lectures/{sprintf(\"lecture-%.2dA.pdf\", weekno)}' target='_blank'></a>"),
      lecture_b ~ glue("B: ", "<a class='fa fa-link' href='lectures/{sprintf(\"lecture-%.2dB.html\", weekno)}' target='_blank'></a> <a class='fab fa-r-project' href='lectures/{sprintf(\"lecture-%.2dB.Rmd\", weekno)}' target='_blank'></a> <a class='fa fa-file-pdf' href='lectures/{sprintf(\"lecture-%.2dB.pdf\", weekno)}' target='_blank'></a>"),
      lecture ~ glue("<a class='fa fa-link' href='lectures/{sprintf(\"lecture-%.2d.html\", weekno)}' target='_blank'></a> <a class='fab fa-r-project' href='lectures/{sprintf(\"lecture-%.2d.Rmd\", weekno)}' target='_blank'></a> <a class='fa fa-file-pdf' href='lectures/{sprintf(\"lecture-%.2d.pdf\", weekno)}' target='_blank'></a>"),
      TRUE ~ ""
    ),
    tut = case_when(
      tutorial & solution ~ glue("<a class='fa fa-tasks' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}.html' target='_blank'></a> <a class='fa fa-wrench' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}.Rmd' target='_blank'></a> <a class='fa fa-lightbulb' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}sol.html' target='_blank'></a> <a class='fa fa-laptop' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}sol.Rmd' target='_blank'></a>&nbsp;<a class='fa fa-folder' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}.zip' target='_blank'></a>"),
      tutorial ~ glue("<a class='fa fa-tasks' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}.html' target='_blank'></a> <a class='fa fa-wrench' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}.Rmd'  target='_blank'></a>&nbsp;<a class='fa fa-folder' href='tutorials/{sprintf(\"tutorial-%.2d\", weekno)}.zip' target='_blank'></a>"),
      TRUE ~ ""
    ),
    topic = ifelse(is.na(topic), "", topic),
    readings = ifelse(is.na(readings), "", readings)
  ) %>%
  select(date, weekno, lecturer, slides, tut, topic, readings, assessment)


midsem_break <- which.min(sem_dates < midsem_date) - 1 + 1 # + 1 is for the fix for when week 0 is added

schedule_df %>%
  kable(
    escape = FALSE, align = c("c", "c", "c", "c", "l", "l", "l"),
    col.names = c(
      "Start Date", "Week", "Lecturer", "Slides", "Tutorial",
      "Topic", "Readings", "Assessments"
    )
  ) %>%
  kable_styling(
    bootstrap_options = "striped",
    fixed_thead = T
  ) %>%
  column_spec(1, width = "0.5cm") %>%
  column_spec(2, width = "1cm") %>%
  column_spec(3, width = "1cm") %>%
  column_spec(4, width = "1cm") %>%
  column_spec(7, width = "6cm") %>%
  group_rows("Midsemester Break (1 week)", midsem_break + 1, 12, label_row_css = "background-color: #d9e1e8;") %>%
  add_indent(1:midsem_break) # this needs to be done to match up with above
```

## Expectations

-   Unless your question is a personal issue or an administrative matter, please do not send us direct email. The moodle discussion forum is appropriate for questions related to the course.
-   For personal or private administrative issues, the email contact is: [ETC5512.Clayton-x\@monash.edu](mailto:ETC5512.Clayton-x@monash.edu){.email}
-   Lectures are recorded, and you are expected to have either attended the lecture, or watched the recordings fully, prior to the tutorial for the week.
-   Tutorials are not recorded, and attendance is expected.
-   Bring your own laptop to the computer labs. If you do not have a laptop you can borrow one from MoVE
-   If you register after the start of the semester or if you miss a lecture/tutorial, it is your responsibility to catch up with missed material, learn about due dates for material to be turned in, and getting assigned to a group for team work, as necessary.
-   The computer software R and RStudio will be used for the unit.
